<div class="display-root">
  <!-- ===== DISPLAY HEADER ===== -->
    <div class="display-header" *ngIf="data">
      <div class="display-title">
        ‡∏ú‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏ï‡∏±‡∏ß‡∏ï‡∏∂‡∏Å‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÉ‡∏ô

      </div>
      

      <div class="display-title">
        <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ admit ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ: <b>{{ patientSummary.total }}</b> ‡∏Ñ‡∏ô</span>
        <span>‡∏ä‡∏≤‡∏¢: <b>{{ patientSummary.male }}</b> ‡∏Ñ‡∏ô</span>
        <span>‡∏´‡∏ç‡∏¥‡∏á: <b>{{ patientSummary.female }}</b> ‡∏Ñ‡∏ô</span>
        <span>
            ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: {{ thaiDateTime }}
        </span>
        <button class="btn-fullscreen" (click)="toggleFullscreen()">
          {{ isFullscreen ? '‚õ∂ ‡∏≠‡∏≠‡∏Å' : '‚õ∂ ‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠' }}
        </button>
        <button class="footer-right"  title="‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä"(click)="refreshBoard()" [disabled]="isRefreshing"> üîÑ </button>
        
      </div>
          
        
        <!-- Loading / Error -->
      <div *ngIf="!data && !error" class="box">
        ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...
      </div>

      <!-- Error -->
      <div *ngIf="error" class="box error">
        {{ error }}
      </div>
    </div>

    <div class="min-h-screen p-4">
      <div class=" ">
        <div class="board-wrapper">
          <!-- ================= WARD MAP ================= -->
          <div *ngIf="data" class="ward-map">
          <!-- ===== ROW TOP ===== -->
          <section class="zone female" *ngIf="data?.zones?.length && data.zones[0]?.rooms">
            <div class="zone-title pink">
              {{ data.zones[0].title }}
            </div>

            <div class="rooms grid-3">
              <ng-container *ngFor="let r of data.zones[0].rooms">
                  <div class="room">
                    <div
                      class="bed clickable"
                      *ngFor="let b of r.beds"
                      [ngClass]="b.status"
                      (click)="onBedClick(b)">
                        <div class="bed-head">
                        <span class="bed-code">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á {{ b.bedno || r.room }}</span>

                      <div class="bed-head-right">
                            <!-- ===== MALE ===== -->
                            <img
                              *ngIf="b.sexType === 'male' && b.ageType === 'child'"
                              src="assets/images/child-male.png"
                              class="head-icon"
                              alt="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢"
                            />

                            <img
                              *ngIf="b.sexType === 'male' && b.ageType === 'adult'"
                              src="assets/images/adult-male.png"
                              class="head-icon"
                              alt="‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢"
                            />

                            <img
                              *ngIf="b.sexType === 'male' && b.ageType === 'elder'"
                              src="assets/images/elder-male.png"
                              class="head-icon"
                              alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ä‡∏≤‡∏¢"
                            />

                            <!-- ===== FEMALE ===== -->
                            <img
                              *ngIf="b.sexType === 'female' && b.ageType === 'child'"
                              src="assets/images/child-female.png"
                              class="head-icon"
                              alt="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á"
                            />

                            <img
                              *ngIf="b.sexType === 'female' && b.ageType === 'adult'"
                              src="assets/images/adult-female.png"
                              class="head-icon"
                              alt="‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á"
                            />

                            <img
                              *ngIf="b.sexType === 'female' && b.ageType === 'elder'"
                              src="assets/images/elder-female.png"
                              class="head-icon"
                              alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏ç‡∏¥‡∏á"
                            />

                             <ng-container *ngIf="getLabStatus(b) as lab">
                        <div class="lab-stack">
                          <img src="assets/images/lab.png" class="status-icon" />

                          <img *ngIf="lab === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'Y' || lab === 'OTHER'"
                              src="assets/images/status-ok.png"
                              class="status-icon lab-overlay" />
                        </div>
                      </ng-container>

                            <!-- ===== XRAY ===== -->
                          <ng-container *ngIf="getXrayStatus(b) as xr">
                            <div class="lab-stack">
                              <img src="assets/images/xray.png" class="status-icon" />

                              <img *ngIf="xr === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'Y' || xr === 'OTHER'"
                                  src="assets/images/status-ok.png"
                                  class="status-icon lab-overlay" />
                            </div>
                          </ng-container>
                      </div>
                           
                      </div>
                      <!-- ===== ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ ===== -->
                      <div class="bed-patient" *ngIf="b.patient">
                        <div class="bed-name">
                          {{ b.patient.patient_name }}
                        </div>

                        <div class="bed-meta">
                           HN {{ b.patient.hn }} 
                        </div>

                        <div class="bed-meta small">
                        ‡∏≠‡∏≤‡∏¢‡∏∏: {{ b.patient.age_y }} ‡∏õ‡∏µ
                      {{ b.patient.age_m }} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                      {{ b.patient.age_d }} ‡∏ß‡∏±‡∏ô 
                        </div>
                      </div>
                    </div>
                </div>
              </ng-container>
            </div>
          </section>
          <!-- ===== ‡∏Å‡∏•‡∏≤‡∏á‡∏à‡∏∏‡∏î‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• / ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á===== -->
          <section class="zone center">  
          <div class="nurse"><img src="assets/images/nurse.png" class="nurse-image" />
            <div class="nurse-title">NURSE STATION</div>
            <div class="nurse-sub">‡∏à‡∏∏‡∏î‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏• / ‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á</div>
          </div>
          </section>
          <!-- ===== ‡πÇ‡∏ã‡∏ô ‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢===== -->
          <!-- ===== ‡πÇ‡∏ã‡∏ô ‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢ ===== -->
          <section class="zone male">
            <div class="zone-title blue">{{ findZone('male')?.title }}</div>

            <div class="rooms grid-3">
              <ng-container *ngFor="let r of findZone('male')?.rooms">
                <div class="room">

                  <div
                    class="bed clickable"
                    *ngFor="let b of r.beds"
                    [ngClass]="b.status"
                    (click)="onBedClick(b)"
                  >

                    <!-- ===== HEAD BED ===== -->
                    <div class="bed-head">
                      <span class="bed-code">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á {{ b.bedno || r.room }}</span>

                      <div class="bed-head-right">
                          <!-- ===== MALE ===== -->
                          <img
                            *ngIf="b.sexType === 'male' && b.ageType === 'child'"
                            src="assets/images/child-male.png"
                            class="head-icon"
                            alt="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢"
                          />

                          <img
                            *ngIf="b.sexType === 'male' && b.ageType === 'adult'"
                            src="assets/images/adult-male.png"
                            class="head-icon"
                            alt="‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢"
                          />

                          <img
                            *ngIf="b.sexType === 'male' && b.ageType === 'elder'"
                            src="assets/images/elder-male.png"
                            class="head-icon"
                            alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ä‡∏≤‡∏¢"
                          />

                          <!-- ===== FEMALE ===== -->
                          <img
                            *ngIf="b.sexType === 'female' && b.ageType === 'child'"
                            src="assets/images/child-female.png"
                            class="head-icon"
                            alt="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á"
                          />

                          <img
                            *ngIf="b.sexType === 'female' && b.ageType === 'adult'"
                            src="assets/images/adult-female.png"
                            class="head-icon"
                            alt="‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á"
                          />

                          <img
                            *ngIf="b.sexType === 'female' && b.ageType === 'elder'"
                            src="assets/images/elder-female.png"
                            class="head-icon"
                            alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏ç‡∏¥‡∏á"
                          />
                           <ng-container *ngIf="getLabStatus(b) as lab">
                        <div class="lab-stack">
                          <img src="assets/images/lab.png" class="status-icon" />

                          <img *ngIf="lab === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'Y' || lab === 'OTHER'"
                              src="assets/images/status-ok.png"
                              class="status-icon lab-overlay" />
                        </div>
                      </ng-container>

                            <!-- ===== XRAY ===== -->
                          <ng-container *ngIf="getXrayStatus(b) as xr">
                            <div class="lab-stack">
                              <img src="assets/images/xray.png" class="status-icon" />

                              <img *ngIf="xr === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'Y' || xr === 'OTHER'"
                                  src="assets/images/status-ok.png"
                                  class="status-icon lab-overlay" />
                            </div>
                          </ng-container>
                        </div>
                    </div>
                    <!-- ===== END HEAD BED ===== -->

                    <!-- ===== BODY ===== -->
                    <div class="bed-patient" *ngIf="b.patient">
                      <div class="bed-name">
                          {{ b.patient.patient_name }}
                        </div>

                        <div class="bed-meta">
                           HN {{ b.patient.hn }} 
                        </div>

                        <div class="bed-meta small">
                      ‡∏≠‡∏≤‡∏¢‡∏∏: {{ b.patient.age_y }} ‡∏õ‡∏µ
                      {{ b.patient.age_m }} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                      {{ b.patient.age_d }} ‡∏ß‡∏±‡∏ô 
                        </div>
                    </div>
                  </div>
                </div>
              </ng-container>
            </div>
          </section>


          <!-- ===== ‡πÇ‡∏ã‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏¥‡πÄ‡∏®‡∏©1 ===== -->
          <section class="zone special special1">
            <div class="zone-title green">{{ findZone('special')?.title }}</div>

            <div class="rooms grid-2">
              <ng-container *ngFor="let r of findZone('special')?.rooms">
                <div class="room">

                  <div
                    class="bed clickable"
                    *ngFor="let b of r.beds"
                    [ngClass]="b.status"
                    (click)="onBedClick(b)"
                  >

                    <!-- ===== HEAD BED ===== -->
                    <div class="bed-head">
                      <span class="bed-code">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á {{ b.bedno || r.room }}</span>

                      <div class="bed-head-right">
                        <!-- ===== MALE ===== -->
                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'child'"
                          src="assets/images/child-male.png"
                          class="head-icon"
                          alt="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢"
                        />

                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'adult'"
                          src="assets/images/adult-male.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢"
                        />

                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'elder'"
                          src="assets/images/elder-male.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ä‡∏≤‡∏¢"
                        />

                        <!-- ===== FEMALE ===== -->
                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'child'"
                          src="assets/images/child-female.png"
                          class="head-icon"
                          alt="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á"
                        />

                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'adult'"
                          src="assets/images/adult-female.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á"
                        />

                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'elder'"
                          src="assets/images/elder-female.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏ç‡∏¥‡∏á"
                        />
                         <ng-container *ngIf="getLabStatus(b) as lab">
                        <div class="lab-stack">
                          <img src="assets/images/lab.png" class="status-icon" />

                          <img *ngIf="lab === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'Y' || lab === 'OTHER'"
                              src="assets/images/status-ok.png"
                              class="status-icon lab-overlay" />
                        </div>
                      </ng-container>

                            <!-- ===== XRAY ===== -->
                          <ng-container *ngIf="getXrayStatus(b) as xr">
                            <div class="lab-stack">
                              <img src="assets/images/xray.png" class="status-icon" />

                              <img *ngIf="xr === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'Y' || xr === 'OTHER'"
                                  src="assets/images/status-ok.png"
                                  class="status-icon lab-overlay" />
                            </div>
                          </ng-container>
                      </div>

                    </div>
                    <!-- ===== END HEAD BED ===== -->

                    <!-- ===== BODY ===== -->
                    <div class="bed-patient" *ngIf="b.patient">
                      <div class="bed-name">
                          {{ b.patient.patient_name }}
                        </div>

                        <div class="bed-meta">
                           HN {{ b.patient.hn }} 
                        </div>

                        <div class="bed-meta small">
                      ‡∏≠‡∏≤‡∏¢‡∏∏: {{ b.patient.age_y }} ‡∏õ‡∏µ
                      {{ b.patient.age_m }} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                      {{ b.patient.age_d }} ‡∏ß‡∏±‡∏ô 
                        </div>
                    </div>

                  </div>

                </div>
              </ng-container>
            </div>
          </section>

          <!-- ===== ROWspecial p03/04  ===== -->
          <section class="zone special special3">
            <div class="zone-title green">
              {{ findZone('special1')?.title }}
            </div>

            <div class="rooms grid-2">
              <ng-container *ngFor="let r of findZone('special1')?.rooms">
                <div class="room">

                  <div
                    class="bed clickable"
                    *ngFor="let b of r.beds"
                    [ngClass]="b.status"
                    (click)="onBedClick(b)"
                  >

                    <!-- ===== HEAD BED ===== -->
                    <div class="bed-head">
                      <span class="bed-code">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á {{ b.bedno || r.room }}</span>

                      <div class="bed-head-right">
                          <!-- ===== MALE ===== -->
                          <img
                            *ngIf="b.sexType === 'male' && b.ageType === 'child'"
                            src="assets/images/child-male.png"
                            class="head-icon"
                            alt="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢"
                          />

                          <img
                            *ngIf="b.sexType === 'male' && b.ageType === 'adult'"
                            src="assets/images/adult-male.png"
                            class="head-icon"
                            alt="‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢"
                          />

                          <img
                            *ngIf="b.sexType === 'male' && b.ageType === 'elder'"
                            src="assets/images/elder-male.png"
                            class="head-icon"
                            alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ä‡∏≤‡∏¢"
                          />

                          <!-- ===== FEMALE ===== -->
                          <img
                            *ngIf="b.sexType === 'female' && b.ageType === 'child'"
                            src="assets/images/child-female.png"
                            class="head-icon"
                            alt="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á"
                          />

                          <img
                            *ngIf="b.sexType === 'female' && b.ageType === 'adult'"
                            src="assets/images/adult-female.png"
                            class="head-icon"
                            alt="‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á"
                          />

                          <img
                            *ngIf="b.sexType === 'female' && b.ageType === 'elder'"
                            src="assets/images/elder-female.png"
                            class="head-icon"
                            alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏ç‡∏¥‡∏á"
                          />
                           <ng-container *ngIf="getLabStatus(b) as lab">
                        <div class="lab-stack">
                          <img src="assets/images/lab.png" class="status-icon" />

                          <img *ngIf="lab === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'Y' || lab === 'OTHER'"
                              src="assets/images/status-ok.png"
                              class="status-icon lab-overlay" />
                        </div>
                      </ng-container>

                            <!-- ===== XRAY ===== -->
                          <ng-container *ngIf="getXrayStatus(b) as xr">
                            <div class="lab-stack">
                              <img src="assets/images/xray.png" class="status-icon" />

                              <img *ngIf="xr === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'Y' || xr === 'OTHER'"
                                  src="assets/images/status-ok.png"
                                  class="status-icon lab-overlay" />
                            </div>
                          </ng-container>
                        </div>

                    </div>
                    <!-- ===== END HEAD BED ===== -->

                    <!-- ===== BODY ===== -->
                    <div class="bed-patient" *ngIf="b.patient">
                      <div class="bed-name">
                          {{ b.patient.patient_name }}
                        </div>

                        <div class="bed-meta">
                           HN {{ b.patient.hn }}
                        </div>

                        <div class="bed-meta small">
                       ‡∏≠‡∏≤‡∏¢‡∏∏: {{ b.patient.age_y }} ‡∏õ‡∏µ
                      {{ b.patient.age_m }} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                      {{ b.patient.age_d }} ‡∏ß‡∏±‡∏ô 
                        </div>
                    </div>

                  </div>

                </div>
              </ng-container>
            </div>
          </section>

            <!-- ===== ROWspecial2  ===== -->
          <section class="zone rehab">
            <div class="zone-title purple">{{ findZone('rehab')?.title }}</div>

            <div class="rooms grid-2">
              <ng-container *ngFor="let r of findZone('rehab')?.rooms">
                <div class="room">

                  <div
                    class="bed clickable"
                    *ngFor="let b of r.beds"
                    [ngClass]="b.status"
                    (click)="onBedClick(b)"
                  >

                    <!-- ===== HEAD BED ===== -->
                    <div class="bed-head">
                      <span class="bed-code">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á {{ b.bedno || r.room }}</span>

                      <div class="bed-head-right">
                        <!-- ===== MALE ===== -->
                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'child'"
                          src="assets/images/child-male.png"
                          class="head-icon"
                          alt="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢"
                        />

                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'adult'"
                          src="assets/images/adult-male.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢"
                        />

                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'elder'"
                          src="assets/images/elder-male.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ä‡∏≤‡∏¢"
                        />

                        <!-- ===== FEMALE ===== -->
                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'child'"
                          src="assets/images/child-female.png"
                          class="head-icon"
                          alt="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á"
                        />

                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'adult'"
                          src="assets/images/adult-female.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á"
                        />

                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'elder'"
                          src="assets/images/elder-female.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏ç‡∏¥‡∏á"
                        />
                         <ng-container *ngIf="getLabStatus(b) as lab">
                        <div class="lab-stack">
                          <img src="assets/images/lab.png" class="status-icon" />

                          <img *ngIf="lab === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'Y' || lab === 'OTHER'"
                              src="assets/images/status-ok.png"
                              class="status-icon lab-overlay" />
                        </div>
                      </ng-container>

                            <!-- ===== XRAY ===== -->
                          <ng-container *ngIf="getXrayStatus(b) as xr">
                            <div class="lab-stack">
                              <img src="assets/images/xray.png" class="status-icon" />

                              <img *ngIf="xr === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'Y' || xr === 'OTHER'"
                                  src="assets/images/status-ok.png"
                                  class="status-icon lab-overlay" />
                            </div>
                          </ng-container>
                      </div>

                    </div>
                    <!-- ===== END HEAD BED ===== -->

                    <!-- ===== BODY ===== -->
                    <div class="bed-patient" *ngIf="b.patient">
                      <div class="bed-name">
                          {{ b.patient.patient_name }}
                        </div>

                        <div class="bed-meta">
                           HN {{ b.patient.hn }} 
                        </div>

                        <div class="bed-meta small">
                       ‡∏≠‡∏≤‡∏¢‡∏∏: {{ b.patient.age_y }} ‡∏õ‡∏µ
                      {{ b.patient.age_m }} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                      {{ b.patient.age_d }} ‡∏ß‡∏±‡∏ô 
                        </div>
                    </div>

                  </div>

                </div>
              </ng-container>
            </div>
          </section>

            <!-- ===== ROWspecial p05  ===== -->
        <section class="zone special p05">
          <div class="zone-title green">
            {{ findZone('special2')?.title }}
          </div>

          <div class="rooms grid-1">
            <ng-container *ngFor="let r of findZone('special2')?.rooms">
              <div class="room">

                <div
                  class="bed clickable"
                  *ngFor="let b of r.beds"
                  [ngClass]="b.status"
                  (click)="onBedClick(b)"
                >

                  <!-- ===== HEAD BED ===== -->
                  <div class="bed-head">
                    <span class="bed-code">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á {{ b.bedno || r.room }}</span>

                    <div class="bed-head-right">
                        <!-- ===== MALE ===== -->
                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'child'"
                          src="assets/images/child-male.png"
                          class="head-icon"
                          alt="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢"
                        />

                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'adult'"
                          src="assets/images/adult-male.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢"
                        />

                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'elder'"
                          src="assets/images/elder-male.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ä‡∏≤‡∏¢"
                        />

                        <!-- ===== FEMALE ===== -->
                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'child'"
                          src="assets/images/child-female.png"
                          class="head-icon"
                          alt="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á"
                        />

                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'adult'"
                          src="assets/images/adult-female.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á"
                        />

                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'elder'"
                          src="assets/images/elder-female.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏ç‡∏¥‡∏á"
                        />
                         <ng-container *ngIf="getLabStatus(b) as lab">
                        <div class="lab-stack">
                          <img src="assets/images/lab.png" class="status-icon" />

                          <img *ngIf="lab === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'Y' || lab === 'OTHER'"
                              src="assets/images/status-ok.png"
                              class="status-icon lab-overlay" />
                        </div>
                      </ng-container>

                            <!-- ===== XRAY ===== -->
                          <ng-container *ngIf="getXrayStatus(b) as xr">
                            <div class="lab-stack">
                              <img src="assets/images/xray.png" class="status-icon" />

                              <img *ngIf="xr === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'Y' || xr === 'OTHER'"
                                  src="assets/images/status-ok.png"
                                  class="status-icon lab-overlay" />
                            </div>
                          </ng-container>
                      </div>

                  </div>
                  <!-- ===== END HEAD BED ===== -->

                  <!-- ===== BODY ===== -->
                  <div class="bed-patient" *ngIf="b.patient">
                    <div class="bed-name">
                          {{ b.patient.patient_name }}
                        </div>

                        <div class="bed-meta">
                           HN {{ b.patient.hn }} 
                        </div>

                        <div class="bed-meta small">
                       ‡∏≠‡∏≤‡∏¢‡∏∏: {{ b.patient.age_y }} ‡∏õ‡∏µ
                      {{ b.patient.age_m }} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                      {{ b.patient.age_d }} ‡∏ß‡∏±‡∏ô 
                        </div>
                  </div>

                </div>

              </div>
            </ng-container>
          </div>
        </section>

          <!-- ===== isolation1  ===== -->
          <section class="zone isolation isolation1">
            <div class="zone-title orange">{{ findZone('isolation')?.title }}</div>

            <div class="rooms grid-1">
              <ng-container *ngFor="let r of findZone('isolation')?.rooms">
                <div class="room">

                  <div
                    class="bed clickable"
                    *ngFor="let b of r.beds"
                    [ngClass]="b.status"
                    (click)="onBedClick(b)"
                  >

                    <!-- ===== HEAD BED ===== -->
                    <div class="bed-head">
                      <span class="bed-code">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á {{ b.bedno || r.room }}</span>

                      <div class="bed-head-right">
                        <!-- ===== MALE ===== -->
                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'child'"
                          src="assets/images/child-male.png"
                          class="head-icon"
                          alt="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢"
                        />

                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'adult'"
                          src="assets/images/adult-male.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢"
                        />

                        <img
                          *ngIf="b.sexType === 'male' && b.ageType === 'elder'"
                          src="assets/images/elder-male.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ä‡∏≤‡∏¢"
                        />

                        <!-- ===== FEMALE ===== -->
                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'child'"
                          src="assets/images/child-female.png"
                          class="head-icon"
                          alt="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á"
                        />

                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'adult'"
                          src="assets/images/adult-female.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á"
                        />

                        <img
                          *ngIf="b.sexType === 'female' && b.ageType === 'elder'"
                          src="assets/images/elder-female.png"
                          class="head-icon"
                          alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏ç‡∏¥‡∏á"
                        />
                           <ng-container *ngIf="getLabStatus(b) as lab">
                        <div class="lab-stack">
                          <img src="assets/images/lab.png" class="status-icon" />

                          <img *ngIf="lab === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'Y' || lab === 'OTHER'"
                              src="assets/images/status-ok.png"
                              class="status-icon lab-overlay" />
                        </div>
                      </ng-container>

                            <!-- ===== XRAY ===== -->
                          <ng-container *ngIf="getXrayStatus(b) as xr">
                            <div class="lab-stack">
                              <img src="assets/images/xray.png" class="status-icon" />

                              <img *ngIf="xr === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'Y' || xr === 'OTHER'"
                                  src="assets/images/status-ok.png"
                                  class="status-icon lab-overlay" />
                            </div>
                          </ng-container>
                      </div>

                    </div>
                    <!-- ===== END HEAD BED ===== -->

                    <!-- ===== BODY ===== -->
                    <div class="bed-patient" *ngIf="b.patient">
                      <div class="bed-name">
                          {{ b.patient.patient_name }}
                        </div>

                        <div class="bed-meta">
                           HN {{ b.patient.hn }} 
                        </div>

                        <div class="bed-meta small">
                      ‡∏≠‡∏≤‡∏¢‡∏∏: {{ b.patient.age_y }} ‡∏õ‡∏µ
                      {{ b.patient.age_m }} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                      {{ b.patient.age_d }} ‡∏ß‡∏±‡∏ô 
                        </div>
                    </div>

                  </div>

                </div>
              </ng-container>
            </div>
          </section>

          <!-- ===== ROWspecial2  ===== -->
          <section class="zone isolation isolation2">
            <div class="zone-title orange">{{ findZone('isolation2')?.title }}</div>

            <div class="rooms grid-1">
              <ng-container *ngFor="let r of findZone('isolation2')?.rooms">
                <div class="room">

                  <div
                    class="bed clickable"
                    *ngFor="let b of r.beds"
                    [ngClass]="b.status"
                    (click)="onBedClick(b)"
                  >

                    <!-- ===== HEAD BED ===== -->
                    <div class="bed-head">
                      <span class="bed-code">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á {{ b.bedno || r.room }}</span>

                      <div class="bed-head-right">
                            <!-- ===== MALE ===== -->
                            <img
                              *ngIf="b.sexType === 'male' && b.ageType === 'child'"
                              src="assets/images/child-male.png"
                              class="head-icon"
                              alt="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢"
                            />

                            <img
                              *ngIf="b.sexType === 'male' && b.ageType === 'adult'"
                              src="assets/images/adult-male.png"
                              class="head-icon"
                              alt="‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢"
                            />

                            <img
                              *ngIf="b.sexType === 'male' && b.ageType === 'elder'"
                              src="assets/images/elder-male.png"
                              class="head-icon"
                              alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ä‡∏≤‡∏¢"
                            />

                            <!-- ===== FEMALE ===== -->
                            <img
                              *ngIf="b.sexType === 'female' && b.ageType === 'child'"
                              src="assets/images/child-female.png"
                              class="head-icon"
                              alt="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á"
                            />

                            <img
                              *ngIf="b.sexType === 'female' && b.ageType === 'adult'"
                              src="assets/images/adult-female.png"
                              class="head-icon"
                              alt="‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á"
                            />

                            <img
                              *ngIf="b.sexType === 'female' && b.ageType === 'elder'"
                              src="assets/images/elder-female.png"
                              class="head-icon"
                              alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏ç‡∏¥‡∏á"
                            />
                            <ng-container *ngIf="getLabStatus(b) as lab">
                        <div class="lab-stack">
                          <img src="assets/images/lab.png" class="status-icon" />

                          <img *ngIf="lab === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'Y' || lab === 'OTHER'"
                              src="assets/images/status-ok.png"
                              class="status-icon lab-overlay" />
                        </div>
                      </ng-container>

                            <!-- ===== XRAY ===== -->
                          <ng-container *ngIf="getXrayStatus(b) as xr">
                            <div class="lab-stack">
                              <img src="assets/images/xray.png" class="status-icon" />

                              <img *ngIf="xr === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'Y' || xr === 'OTHER'"
                                  src="assets/images/status-ok.png"
                                  class="status-icon lab-overlay" />
                            </div>
                          </ng-container>

                          </div>

                    </div>
                    <!-- ===== END HEAD BED ===== -->

                    <!-- ===== BODY ===== -->
                    <div class="bed-patient" *ngIf="b.patient">
                      <div class="bed-name">
                          {{ b.patient.patient_name }}
                        </div>

                        <div class="bed-meta">
                           HN {{ b.patient.hn }} 
                        </div>

                        <div class="bed-meta small">
                       ‡∏≠‡∏≤‡∏¢‡∏∏: {{ b.patient.age_y }} ‡∏õ‡∏µ
                      {{ b.patient.age_m }} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                      {{ b.patient.age_d }} ‡∏ß‡∏±‡∏ô 
                        </div>
                      </div>

                  </div>

                </div>
              </ng-container>
            </div>
          </section>


          <!-- ===== EXTRA BED ZONE (‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°) ===== -->
         <section class="zone zone--extra">
          <div class="zone-title">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°</div>

          <div class="rooms grid-2">
            <ng-container *ngFor="let r of findZone('extra')?.rooms">
              <div class="room">

                <div
                  class="bed clickable"
                  *ngFor="let b of r.beds"
                  [ngClass]="b.status"
                  (click)="onBedClick(b)"
                >

                  <!-- ===== HEAD BED ===== -->
                  <div class="bed-head">
                    <span class="bed-code">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á {{ b.bedno || r.room }}</span>

                    <div class="bed-head-right">
                      <!-- ===== MALE ===== -->
                      <img
                        *ngIf="b.sexType === 'male' && b.ageType === 'child'"
                        src="assets/images/child-male.png"
                        class="head-icon"
                        alt="‡πÄ‡∏î‡πá‡∏Å‡∏ä‡∏≤‡∏¢"
                      />

                      <img
                        *ngIf="b.sexType === 'male' && b.ageType === 'adult'"
                        src="assets/images/adult-male.png"
                        class="head-icon"
                        alt="‡∏ú‡∏π‡πâ‡∏ä‡∏≤‡∏¢"
                      />

                      <img
                        *ngIf="b.sexType === 'male' && b.ageType === 'elder'"
                        src="assets/images/elder-male.png"
                        class="head-icon"
                        alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏ä‡∏≤‡∏¢"
                      />

                      <!-- ===== FEMALE ===== -->
                      <img
                        *ngIf="b.sexType === 'female' && b.ageType === 'child'"
                        src="assets/images/child-female.png"
                        class="head-icon"
                        alt="‡πÄ‡∏î‡πá‡∏Å‡∏´‡∏ç‡∏¥‡∏á"
                      />

                      <img
                        *ngIf="b.sexType === 'female' && b.ageType === 'adult'"
                        src="assets/images/adult-female.png"
                        class="head-icon"
                        alt="‡∏ú‡∏π‡πâ‡∏´‡∏ç‡∏¥‡∏á"
                      />

                      <img
                        *ngIf="b.sexType === 'female' && b.ageType === 'elder'"
                        src="assets/images/elder-female.png"
                        class="head-icon"
                        alt="‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡∏´‡∏ç‡∏¥‡∏á"
                      />
                      <ng-container *ngIf="getLabStatus(b) as lab">
                        <div class="lab-stack">
                          <img src="assets/images/lab.png" class="status-icon" />

                          <img *ngIf="lab === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                          <img *ngIf="lab === 'Y' || lab === 'OTHER'"
                              src="assets/images/status-ok.png"
                              class="status-icon lab-overlay" />
                        </div>
                      </ng-container>

                            <!-- ===== XRAY ===== -->
                          <ng-container *ngIf="getXrayStatus(b) as xr">
                            <div class="lab-stack">
                              <img src="assets/images/xray.png" class="status-icon" />

                              <img *ngIf="xr === 'W'" src="assets/images/status-report.png" class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'C'" src="assets/images/status-wait.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'N'" src="assets/images/status-none.png"   class="status-icon lab-overlay" />
                              <img *ngIf="xr === 'Y' || xr === 'OTHER'"
                                  src="assets/images/status-ok.png"
                                  class="status-icon lab-overlay" />
                            </div>
                          </ng-container>

                    </div>

                  </div>
                  <!-- ===== END HEAD BED ===== -->

                 <div class="bed-patient" *ngIf="b.patient">
                  <div class="bed-name">
                          {{ b.patient.patient_name }}
                        </div>

                        <div class="bed-meta">
                           HN {{ b.patient.hn }} 
                        </div>

                        <div class="bed-meta small">
                      ‡∏≠‡∏≤‡∏¢‡∏∏: {{ b.patient.age_y }} ‡∏õ‡∏µ
                      {{ b.patient.age_m }} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                      {{ b.patient.age_d }} ‡∏ß‡∏±‡∏ô 
                        </div>
                </div>
                 

                </div>

              </div>
            </ng-container>
          </div>
        </section>
       <!-- ‚≠ê  NOTE BOX (‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏•‡∏≤‡∏Å‡∏≠‡∏¥‡∏™‡∏£‡∏∞) -->
        <div
          class="note-toggle-star"
          title="‡πÄ‡∏õ‡∏¥‡∏î"
          *ngIf="isCollapsed"
          (click)="toggleNote()"
        >
          ‚≠ê
        </div>

          <!-- ‚≠ê FLOATING NOTE BOX (‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏•‡∏≤‡∏Å‡∏≠‡∏¥‡∏™‡∏£‡∏∞) -->

          <div
            class="floating-note"
            *ngIf="!isCollapsed"
            cdkDrag
            cdkDragBoundary="body"
            [cdkDragFreeDragPosition]="notePosition"
            (cdkDragEnded)="onNoteDragEnd($event)"
          >
            <button class="note-star"  title="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î"(click)="openLegend()">üìå</button>
            <!-- üî∏ HEADER -->
            <div class="note-header" cdkDragHandle>
              <span>üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</span>

              <!-- ‚≠ê ‡∏õ‡∏∏‡πà‡∏°‡∏û‡∏±‡∏ö -->
              <button class="star-btn"   title="‡∏õ‡∏¥‡∏î" (click)="toggleNote()">
                ‚≠ê
              </button>
            </div>

            <!-- BODY -->
            <div class="note-body">
              <textarea
                [(ngModel)]="noteText"
                (input)="saveNote()"
                placeholder="‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏î‡πâ..."
              ></textarea>
            </div>
          </div>


  
          <!-- ===== WAITING BED FOOTER ===== -->
          <div class="waiting-footer" *ngIf="waitingList.length > 0">
              <div class="waiting-title">
              ‚è≥ ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ï‡∏µ‡∏¢‡∏á ({{ waitingList.length }} ‡∏Ñ‡∏ô)
              </div>

              <div class="waiting-list">
                <div
                  class="waiting-card clickable"
                  *ngFor="let p of waitingList"
                  (click)="openWaitingDetail(p)"
                >
                  <div class="hn">{{ p.hn }}</div>
                  <div class="name">{{ p.patient_name }}</div>
                </div>
              </div>
            </div>

            <div class="waiting-footer empty" *ngIf="waitingList.length === 0">
              üõèÔ∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ï‡∏µ‡∏¢‡∏á
            </div>
        </div>
       </div>
      </div>
    
    

      <!-- ================= POPUP DETAIL ================= -->
      <div class="modal-backdrop" *ngIf="showModal">
        <div class="modal">

          <!-- HEADER -->
          <div class="modal-header">
            <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</h3>
            <button class="close-btn" (click)="closeModal()">‚úï</button>
          </div>

          <!-- BODY -->
          <div class="modal-body" *ngIf="selectedPatient">
            <div class="bed-info" *ngIf="selectedBed">
              <span class="label">‡πÄ‡∏ï‡∏µ‡∏¢‡∏á:</span>
              <span class="value">
                {{ selectedBed.bedno }}
                <span *ngIf="selectedBed.room"> (‡∏´‡πâ‡∏≠‡∏á: {{ selectedBed.room }})</span>
                <span *ngIf="selectedBed.zone"> - {{ selectedBed.zone }}</span>
              </span>
            </div>
            <div class="info-row">
              <span class="label">AN</span>
              <span class="value">{{ selectedPatient.an }}</span>
            </div>

            <div class="info-row">
              <span class="label">HN</span>
              <span class="value">{{ selectedPatient.hn }}</span>
            </div>

            <div class="info-row">
              <span class="label">‡∏ä‡∏∑‡πà‡∏≠ - ‡∏™‡∏Å‡∏∏‡∏•:</span>
              <span class="value">{{ selectedPatient.patient_name }}</span>
            </div>

            <div class="info-row">
              <span class="label">‡∏≠‡∏≤‡∏¢‡∏∏:</span>
              <span class="value">
                {{ selectedPatient.age_y }} ‡∏õ‡∏µ
                {{ selectedPatient.age_m }} ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
                {{ selectedPatient.age_d }} ‡∏ß‡∏±‡∏ô
              </span>
            </div>

            <div class="info-row">
              <span class="label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å‡∏£‡∏±‡∏Å‡∏©‡∏≤:</span>
              <span class="value">
                {{ selectedPatient.regdate | date:'dd/MM/yyyy' }}
              </span>
            </div>

            <div class="info-row">
              <span class="label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏≠‡∏ô:</span>
              <span class="value">
                {{ selectedPatient.admdate }} ‡∏ß‡∏±‡∏ô
              </span>
            </div>

            <div class="info-row">
              <span class="label">‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤:</span>
              <span class="value">{{ selectedPatient.pttype_name }}</span>
            </div>

            <div class="info-row">
              <span class="label">‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÑ‡∏Ç‡πâ:</span>
              <span class="value">{{ selectedPatient.admdoctor_name }}</span>
            </div>
            <!-- ===== LAB ===== -->
            <div class="info-row">
              <span class="label">Lab:</span>
              <span class="value lab-inline" *ngIf="selectedPatient?.lab_status; else noLab">
                <img src="assets/images/lab.png" class="status-icon" />

                <img *ngIf="selectedPatient.lab_status === 'W'"
                    src="assets/images/status-report.png"
                    class="status-icon lab-overlay" />

                <img *ngIf="selectedPatient.lab_status === 'C'"
                    src="assets/images/status-wait.png"
                    class="status-icon lab-overlay" />

                <img *ngIf="selectedPatient.lab_status === 'N'"
                    src="assets/images/status-none.png"
                    class="status-icon lab-overlay" />

                <img *ngIf="selectedPatient.lab_status === 'Y'"
                    src="assets/images/status-ok.png"
                    class="status-icon lab-overlay" />

                <span class="status-text">
                  {{ getLabText(selectedPatient.lab_status) }}
                </span>
              </span>

              <ng-template #noLab>‚Äì</ng-template>
            </div>

            <!-- ===== XRAY ===== -->
            <div class="info-row">
              <span class="label">X-ray:</span>
              <span class="value lab-inline" *ngIf="selectedPatient?.xray_status; else noXray">
                <img src="assets/images/xray.png" class="status-icon" />

                <img *ngIf="selectedPatient.xray_status === 'W'"
                    src="assets/images/status-report.png"
                    class="status-icon lab-overlay" />

                <img *ngIf="selectedPatient.xray_status === 'C'"
                    src="assets/images/status-wait.png"
                    class="status-icon lab-overlay" />

                <img *ngIf="selectedPatient.xray_status === 'N'"
                    src="assets/images/status-none.png"
                    class="status-icon lab-overlay" />

                <img *ngIf="selectedPatient.xray_status === 'Y'"
                    src="assets/images/status-ok.png"
                    class="status-icon lab-overlay" />

                <span class="status-text">
                  {{ getXrayText(selectedPatient.xray_status) }}
                </span>
              </span>

              <ng-template #noXray>‚Äì</ng-template>
            </div>

          </div>

          

      </div>
    </div>


</div>

<div class="legend-backdrop" *ngIf="showLegend">
  <div class="legend-popup">

    <!-- HEADER -->
    <div class="legend-header">
      <span>üìå ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏±‡∏ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå</span>
      <button class="legend-close"  title="‡∏õ‡∏¥‡∏î"(click)="closeLegend()">‚úï</button>
    </div>

    <!-- BODY -->
    <div class="legend-body">

      <div class="legend-section">
        <div class="legend-item">üß™ <span>‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ï‡∏£‡∏ß‡∏à Lab</span></div>
        <div class="legend-item">ü©ª <span>‡∏°‡∏µ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á X-ray</span></div>
      </div>

      <hr />

      <div class="legend-section">
        <div class="legend-title">Status</div>

        <div class="legend-item">‚è≥ <span>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</span></div>
        <div class="legend-item">‚è∞ <span>‡∏£‡∏≠‡∏ú‡∏•‡∏ï‡∏£‡∏ß‡∏à</span></div>
        <div class="legend-item">üìÑ <span>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡πÅ‡∏•‡πâ‡∏ß</span></div>
        <div class="legend-item">‚úÖ <span>‡∏ú‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</span></div>
      </div>

    </div>
  </div>
</div>
